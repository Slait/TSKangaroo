# RCKangaroo Server - Запуск в Windows

## Быстрый старт

### 1. Подготовка системы

1. **Установите Python 3.7 или выше**
   - Скачайте с https://python.org/downloads/
   - **Важно**: Поставьте галочку "Add Python to PATH" при установке

2. **Проверьте установку**
   ```cmd
   python --version
   ```

### 2. Автоматическая настройка сервера

1. **Запустите скрипт установки**
   ```cmd
   setup_server_windows.bat
   ```
   
   Этот скрипт:
   - Проверит Python и pip
   - Установит Flask и requests
   - Создаст стартовые скрипты
   - Настроит среду для запуска

### 3. Запуск сервера

**Простой запуск (только локально):**
```cmd
start_server.bat
```

**Запуск для сетевого доступа:**
```cmd
start_server_custom.bat 0.0.0.0 8080
```

**Ручной запуск:**
```cmd
python kangaroo_server.py --host 0.0.0.0 --port 8080
```

### 4. Настройка поиска

**Автоматическая настройка для Bitcoin Puzzle:**
```cmd
configure_bitcoin_puzzle.bat
```

**Ручная настройка:**
```cmd
configure_search.bat
```

## Примеры конфигурации

### Bitcoin Puzzle #85 (самый популярный)
```json
{
  "start_range": "0x1000000000000000000000",
  "end_range": "0x1FFFFFFFFFFFFFFFFFFFFF",
  "pubkey": "0329c4574a4fd8c810b7e42a4b398882b381bcd85e40c6883712912d167c83e73a",
  "dp_bits": 16,
  "range_size": "0x100000000000000"
}
```

### Для тестирования (Puzzle #64, уже решен)
```json
{
  "start_range": "0x8000000000000000",
  "end_range": "0xFFFFFFFFFFFFFFFE",
  "pubkey": "0320d8e8133df7eca2dc8c8b4cf2c50b05eeb2c5b6594518194ccca95e45bb19e0e8",
  "dp_bits": 14,
  "range_size": "0x10000000000000"
}
```

## Настройка Windows Firewall

### Автоматическое разрешение
При первом запуске сервера Windows может показать диалог брандмауэра:
- **Выберите "Разрешить доступ"** если хотите принимать подключения от других компьютеров

### Ручная настройка
1. Откройте "Панель управления" → "Брандмауэр Windows"
2. Нажмите "Разрешить программу или компонент"
3. Найдите Python и разрешите ему доступ через брандмауэр
4. Или разрешите порт 8080 через "Дополнительные параметры"

## Мониторинг сервера

### Веб-интерфейс
Откройте в браузере: `http://localhost:8080`

### API статуса
```cmd
curl http://localhost:8080/api/status
```

### Проверка с другого компьютера
```cmd
curl http://IP_СЕРВЕРА:8080/api/status
```

## Типичные проблемы

### Python не найден
```cmd
'python' не является внутренней или внешней командой
```
**Решение**: Переустановите Python с галочкой "Add Python to PATH"

### Порт занят
```
Address already in use
```
**Решение**: Измените порт или завершите другой процесс:
```cmd
netstat -ano | findstr :8080
taskkill /F /PID [номер_процесса]
```

### Брандмауэр блокирует подключения
**Симптомы**: Клиенты не могут подключиться с других машин
**Решение**: Разрешите Python через брандмауэр (см. выше)

### Низкая производительность
**Симптомы**: Много клиентов, сервер тормозит
**Решения**:
- Используйте SSD для базы данных
- Увеличьте оперативную память
- Запускайте на многоядерном процессоре

## Файлы и папки

```
server/
├── kangaroo_server.py          # Основной сервер
├── collision_solver.py         # Решатель коллизий
├── requirements.txt            # Python зависимости
├── setup_server_windows.bat    # Установщик для Windows
├── start_server.bat           # Простой запуск
├── start_server_custom.bat    # Запуск с параметрами
├── configure_bitcoin_puzzle.bat # Настройка для Bitcoin Puzzle
├── configure_search.bat       # Настройка параметров поиска
└── kangaroo_server.db         # База данных (создается автоматически)
```

## Бэкап базы данных

**Важно**: Регулярно создавайте копии файла `kangaroo_server.db`

```cmd
copy kangaroo_server.db backup_YYYYMMDD.db
```

Или используйте планировщик задач Windows для автоматического бэкапа.

## Производительность

### Рекомендуемые характеристики сервера
- **CPU**: 4+ ядра
- **RAM**: 8+ GB
- **Хранилище**: SSD (база данных может вырасти до нескольких GB)
- **Сеть**: Хорошее соединение для множества клиентов

### Масштабирование
- 1-10 клиентов: Подойдет обычный компьютер
- 10-100 клиентов: Желательно выделенный сервер
- 100+ клиентов: Требуется мощный сервер

## Безопасность

1. **Не открывайте сервер в интернет** без дополнительной защиты
2. Используйте только в доверенных сетях
3. Регулярно обновляйте Python и зависимости
4. Мониторьте использование ресурсов

## Получение помощи

Если возникли проблемы:
1. Проверьте логи сервера
2. Убедитесь, что порт 8080 открыт
3. Проверьте настройки брандмауэра
4. Посмотрите примеры в `DISTRIBUTED_README.md`